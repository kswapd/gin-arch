webpackJsonp([33],{"2amb":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("mvHQ"),s=a.n(i),l=a("ifoU"),o=a.n(l),n=a("Dd8w"),r=a.n(n),h=a("ZlkZ"),c=a("NYxO"),m=a("egE+"),d={data:function(){return{date:m.a,time:{text:"1小时",value:3600},resizeIds:[{id:"clients_pie",width:30},{id:"clients_line",width:70},{id:"memo_pie",width:30},{id:"memo_line",width:70},{id:"keys_pie",width:30},{id:"keys_line",width:70},{id:"hitRates_pie",width:30},{id:"hitRates_line",width:70}],titleColor:"#000",tabName:"clientsTitle",timer:null,loading:!1,clientsLast:-1,memoLast:-1,keysLast:-1,hitRatesLast:-1,clientsAllData:[],memoAllData:[],keysAllData:[],hitRatesAllData:[],clientsData:"",keysData:"",clientsShow:!0,memoShow:!0,keysShow:!0,hitRatesShow:!0}},computed:r()({},Object(c.d)({isCollapse:function(t){return t.app.isCollapse},theme:function(t){return t.app.theme}}),{redisParams:function(){var t=new o.a([[3600,"time(30s)"],[10800,"time(1m)"],[43200,"time(3m)"],[86400,"time(5m)"],[259200,"time(15m)"],[604800,"time(30m)"],[2592e3,"time(2h)"],[15552e3,"time(12h)"],[31536e3,"time(1d)"]]).get(this.time.value),e=this;return{moType:"Redis",ip:e.$route.query.ip,port:e.$route.query.port,jsonTime:{clients:e.clientsLast,hitRates:e.memoLast,keys:e.keysLast,memory:e.hitRatesLast},resolution:t,timeRange:-1===e.clientsLast?e.time.value:3600}}}),watch:{clientsAllData:function(t){t.length>0&&(this.clientsShow=!0,this.clientsLast=t[t.length-1].time,this.clientsEcharts(t[t.length-1].value.toFixed(2),t))},memoAllData:function(t){t.length>0&&(this.memoShow=!0,this.memoLast=t[t.length-1].time,this.memoryEcharts(t[t.length-1].value.toFixed(2),t))},keysAllData:function(t){t.length>0&&(this.keysShow=!0,this.keysLast=t[t.length-1].time,this.keysEcharts(t[t.length-1].value.toFixed(2),t))},hitRatesAllData:function(t){t.length>0&&(this.hitRatesShow=!0,this.hitRatesLast=t[t.length-1].time,this.hitRatesEcharts(t[t.length-1].value.toFixed(2),t))},theme:function(t){if(this.$route.query){this.titleColor={dark:"#ccc"}[t]||"#000",this.echartChange()}}},mounted:function(){this.$route.query&&this.echartChange()},beforeDestroy:function(){clearInterval(this.timer),this.timer=null},methods:{getData:function(){var t=this;t.loading=!0,t.initData(t.redisParams),t.timer=setInterval(function(){t.initData(t.redisParams)},3e4)},initData:function(t){var e=this;e.$axios({method:"post",url:h.a.findRedisAll,data:s()(t)}).then(function(t){if(e.loading=!1,-1===e.redisParams.jsonTime.clients){var a=t.data,i=a.clients,s=a.memory,l=a.keys,o=a.hitRates;e.clientsAllData=i||[],e.memoAllData=s||[],e.keysAllData=l||[],e.hitRatesAllData=o||[]}else t.data.clients&&t.data.clients.length>0&&(e.clientsAllData=m.b.arrayConcat(e.clientsAllData,t.data.clients)),t.data.memory&&t.data.memory.length>0&&(e.memoAllData=m.b.arrayConcat(e.memoAllData,t.data.memory)),t.data.keys&&t.data.keys.length>0&&(e.keysAllData=m.b.arrayConcat(e.keysAllData,t.data.keys)),t.data.hitRates&&t.data.hitRates.length>0&&(e.hitRatesAllData=m.b.arrayConcat(e.hitRatesAllData,t.data.hitRates))}).catch(function(t){e.loading=!1,e.$message.error(t&&t.data&&t.data.message||"ERROR")})},echartChange:function(t){clearInterval(this.timer),this.timer=null,this.time=t||{text:"1小时",value:3600},this.clientsAllData=[],this.memoAllData=[],this.keysAllData=[],this.hitRatesAllData=[],this.clientsShow=!1,this.memoShow=!1,this.keysShow=!1,this.hitRatesShow=!1,this.clientsLast=-1,this.memoLast=-1,this.keysLast=-1,this.hitRatesLast=-1,this.getData()},initEcharts:function(t,e,a){var i=this,s=this.$refs[t];s.style.width=this.$refs.tabWidth.clientWidth*(a/100)+"px",null!==e&&this.$echarts.init(s).setOption(e,!0),window.addEventListener("resize",function(){s.style.width=i.$refs.tabWidth.clientWidth*(a/100)+"px",i.$echarts.init(s).resize()})},dealAxisData:function(t,e,a){var i=this;a.map(function(a){t.push(i.dateFtt("yyyy-MM-dd hh:mm:ss",new Date(parseInt(a.time)))),e.push(a.value.toFixed(2))})},clientsEcharts:function(t,e){var a=this,i=[],s=[];if(e.length>0){a.dealAxisData(i,s,e),a.clientsData={title:"连接数实时监控",num:parseInt(t).toFixed(0)+"个",time:i[i.length-1]};var l={tooltip:{trigger:"axis"},title:{text:"连接数统计(个)",left:"center",top:10,textStyle:{color:a.titleColor}},xAxis:{boundaryGap:!1,type:"category",axisLine:{symbol:["none","arrow"],symbolOffset:[0,10],lineStyle:{color:"#1e98d3",width:1}},axisTick:{length:"0"},axisLabel:{color:"#1e98d3"},splitLine:{show:!1},data:i},yAxis:{type:"value",axisLine:{symbol:["none","arrow"],symbolOffset:[0,10],lineStyle:{color:"#1e98d3",width:1}},axisTick:{length:"0"},axisLabel:{formatter:"{value}(个)",color:"#1e98d3"},splitLine:{show:!0,color:"#fefefe"}},series:[{name:"连接数统计",type:"line",itemStyle:{color:"#67C23A",lineStyle:{color:"#67C23A",width:1}},data:s}]};this.initEcharts("clients_line",l,a.resizeIds[1].width),a.clientsShow=!0}else a.clientsShow=!1},memoryEcharts:function(t,e){var a=this,i=[],s=[];if(e.length>0){a.dealAxisData(i,s,e);var l={tooltip:{formatter:"{a} <br/>{b} : {c}%"},title:{text:"Memory实时监控(%)",subtext:"时间："+i[i.length-1],textStyle:{color:a.titleColor},subtextStyle:{lineHeight:0,rich:{a:{lineHeight:0}}},left:10,top:-5},series:[{name:"Memory实时监控",type:"gauge",radius:"70%",center:["58%","50%"],min:0,max:100,axisTick:{length:10},axisLabel:{color:"black",distance:-1},axisLine:{lineStyle:{width:10,shadowBlur:0,color:[[.3,"#67e0e3"],[.7,"#37a2da"],[1,"#fd666d"]]}},detail:{formatter:"{value}"},data:[{value:t}]}]},o={tooltip:{trigger:"axis"},title:{text:"Memory统计",left:"center",top:10,textStyle:{color:a.titleColor}},xAxis:{boundaryGap:!1,type:"category",axisLine:{symbol:["none","arrow"],symbolOffset:[0,10],lineStyle:{color:"#1e98d3",width:1}},axisTick:{length:"0"},axisLabel:{color:"#1e98d3"},data:i},yAxis:{type:"value",axisLine:{symbol:["none","arrow"],symbolOffset:[0,10],lineStyle:{color:"#1e98d3",width:1}},axisTick:{length:"0"},axisLabel:{formatter:"{value}(kb)",color:"#1e98d3"}},series:[{name:"Memory统计",type:"line",itemStyle:{color:"#67C23A",lineStyle:{color:"#67C23A",width:1}},data:s}]};this.initEcharts("memo_pie",l,a.resizeIds[2].width),this.initEcharts("memo_line",o,a.resizeIds[3].width),a.memoShow=!0}else a.memoShow=!1},keysEcharts:function(t,e){var a=this,i=[],s=[];if(e.length>0){a.dealAxisData(i,s,e),a.keysData={title:"keys数量实时监控",num:parseInt(t).toFixed(0)+"个",time:i[i.length-1]};var l={tooltip:{trigger:"axis"},title:{text:"keys数量统计(个)",left:"center",top:10,textStyle:{color:a.titleColor}},xAxis:{boundaryGap:!1,type:"category",axisLine:{symbol:["none","arrow"],symbolOffset:[0,10],lineStyle:{color:"#1e98d3",width:1}},axisTick:{length:"0"},axisLabel:{color:"#1e98d3"},splitLine:{show:!1},data:i},yAxis:{type:"value",axisLine:{symbol:["none","arrow"],symbolOffset:[0,10],lineStyle:{color:"#1e98d3",width:1}},axisTick:{length:"0"},axisLabel:{formatter:"{value}(个)",color:"#1e98d3"},splitLine:{show:!0,color:"#fefefe"}},series:[{name:"keys数量统计",type:"line",itemStyle:{color:"#67C23A",lineStyle:{color:"#67C23A",width:1}},data:s}]};this.initEcharts("keys_line",l,a.resizeIds[5].width),a.keysShow=!0}else a.keysShow=!1},hitRatesEcharts:function(t,e){var a=this,i=[],s=[];if(e.length>0){a.dealAxisData(i,s,e);var l={tooltip:{formatter:"{a} <br/>{b} : {c}%"},title:{text:"请求命中率实时监控(%)",subtext:"时间："+i[i.length-1],textStyle:{color:a.titleColor},subtextStyle:{lineHeight:0,rich:{a:{lineHeight:0}}},left:10,top:-5},series:[{name:"请求命中率实时监控",type:"gauge",radius:"70%",center:["58%","50%"],min:0,max:100,axisTick:{length:10},axisLabel:{color:"black",distance:-1},axisLine:{lineStyle:{width:10,shadowBlur:0,color:[[.3,"#67e0e3"],[.7,"#37a2da"],[1,"#fd666d"]]}},detail:{formatter:"{value}"},data:[{value:t}]}]},o={tooltip:{trigger:"axis"},title:{text:"请求命中率(%)",left:"center",top:10,textStyle:{color:a.titleColor}},xAxis:{boundaryGap:!1,type:"category",axisLine:{symbol:["none","arrow"],symbolOffset:[0,10],lineStyle:{color:"#1e98d3",width:1}},axisTick:{length:"0"},axisLabel:{color:"#1e98d3"},data:i},yAxis:{type:"value",min:0,max:100,axisLine:{symbol:["none","arrow"],symbolOffset:[0,10],lineStyle:{color:"#1e98d3",width:1}},axisTick:{length:"0"},axisLabel:{formatter:"{value}(%)",color:"#1e98d3"}},series:[{name:"请求命中率",type:"line",itemStyle:{color:"#67C23A",lineStyle:{color:"#67C23A",width:1}},data:s}]};this.initEcharts("hitRates_pie",l,a.resizeIds[6].width),this.initEcharts("hitRates_line",o,a.resizeIds[7].width),a.hitRatesShow=!0}else a.hitRatesShow=!1}}},y={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"redis-echarts"},[a("div",{staticClass:"detail-back"},[a("a",{on:{click:function(e){t.$router.push({name:"redisList"})}}},[a("i",{staticClass:"iconfont icon-fanhui"}),t._v("返回")]),t._v(" "),a("span",{domProps:{textContent:t._s(t.$route.meta.title+"-"+t.$route.query.ip)}})]),t._v(" "),a("el-row",{staticClass:"rd_bottom"},[a("span",{staticStyle:{"line-height":"40px"}},[t._v(t._s(t.$t("echarts.timeSpan")+"："))]),t._v(" "),t._l(t.date,function(e){return a("el-button",{key:e.value,class:{chooseColor:e.text===t.time.text},attrs:{size:"mini",loading:t.loading},on:{click:function(a){t.echartChange(e)}}},[t._v(t._s(e.text)+"\n    ")])})],2),t._v(" "),a("div",[a("span",[t._v("时间：")]),a("span",{staticClass:"rd_time"},[t._v(t._s(t.time.text))]),t._v(" "),a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"tabWidth"},[a("el-tabs",{model:{value:t.tabName,callback:function(e){t.tabName=e},expression:"tabName"}},[a("el-tab-pane",{attrs:{label:t.$t("redisEcharts.clientsTitle"),name:"clientsTitle"}},[a("el-row",{directives:[{name:"show",rawName:"v-show",value:t.clientsShow,expression:"clientsShow"}]},[a("el-col",{attrs:{span:8}},[a("div",{ref:"clients_pie",staticClass:"echarts"},[a("dc-num-show",{attrs:{"num-data":t.clientsData}})],1)]),t._v(" "),a("el-col",{attrs:{span:16}},[a("div",{ref:"clients_line",staticClass:"echarts"})])],1),t._v(" "),a("el-row",{directives:[{name:"show",rawName:"v-show",value:!t.clientsShow,expression:"!clientsShow"}],staticClass:"no-data"},[a("el-col",[t._v("暂无数据")])],1)],1),t._v(" "),a("el-tab-pane",{attrs:{label:t.$t("redisEcharts.memoTitle"),name:"memoTitle"}},[a("el-row",{directives:[{name:"show",rawName:"v-show",value:t.memoShow,expression:"memoShow"}]},[a("el-col",{attrs:{span:8}},[a("div",{ref:"memo_pie",staticClass:"echarts"})]),t._v(" "),a("el-col",{attrs:{span:16}},[a("div",{ref:"memo_line",staticClass:"echarts"})])],1),t._v(" "),a("el-row",{directives:[{name:"show",rawName:"v-show",value:!t.memoShow,expression:"!memoShow"}],staticClass:"no-data"},[a("el-col",[t._v("暂无数据")])],1)],1),t._v(" "),a("el-tab-pane",{attrs:{label:t.$t("redisEcharts.keysTitle"),name:"keysTitle"}},[a("el-row",{directives:[{name:"show",rawName:"v-show",value:t.keysShow,expression:"keysShow"}]},[a("el-col",{attrs:{span:8}},[a("div",{ref:"keys_pie",staticClass:"echarts"},[a("dc-num-show",{attrs:{"num-data":t.keysData}})],1)]),t._v(" "),a("el-col",{attrs:{span:16}},[a("div",{ref:"keys_line",staticClass:"echarts"})])],1),t._v(" "),a("el-row",{directives:[{name:"show",rawName:"v-show",value:!t.keysShow,expression:"!keysShow"}],staticClass:"no-data"},[a("el-col",[t._v("暂无数据")])],1)],1),t._v(" "),a("el-tab-pane",{attrs:{label:t.$t("redisEcharts.hitRatesTitle"),name:"hitRatesTitle"}},[a("el-row",{directives:[{name:"show",rawName:"v-show",value:t.hitRatesShow,expression:"hitRatesShow"}]},[a("el-col",{attrs:{span:8}},[a("div",{ref:"hitRates_pie",staticClass:"echarts"})]),t._v(" "),a("el-col",{attrs:{span:16}},[a("div",{ref:"hitRates_line",staticClass:"echarts"})])],1),t._v(" "),a("el-row",{directives:[{name:"show",rawName:"v-show",value:!t.hitRatesShow,expression:"!hitRatesShow"}],staticClass:"no-data"},[a("el-col",[t._v("暂无数据")])],1)],1)],1)],1)])],1)},staticRenderFns:[]};var w=a("VU/8")(d,y,!1,function(t){a("qbUF")},"data-v-4bc2acd9",null);e.default=w.exports},qbUF:function(t,e){}});