webpackJsonp([69],{syx4:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a("Xxa5"),i=a.n(n),l=a("exGp"),r=a.n(l),o=a("Dd8w"),s=a.n(o),d=a("NYxO"),p={data:function(){return{tableLoading:!0,handleTitle:"",handleVisible:!1,delVisible:!1,columns:[{text:"编号",dataIndex:"id",width:70},{text:"部门名称",dataIndex:"text"},{text:"排序",dataIndex:"order_num"},{text:"状态",dataIndex:"del_flag",type:"status"}],treeHandel:{text:"系统操作",width:160},deptForm:{parent_name:"",parent_id:"",name:"",order_num:"",del_flag:"0"}}},computed:s()({},Object(d.d)({deptDataList:function(e){return e.authority.deptDataList}})),mounted:function(){this.getData()},methods:s()({},Object(d.b)("authority",["getDeptList","addNewDept","editDept","removeDept","deptListById"]),{getData:function(){this.getDeptList(this)},resetForm:function(){this.deptForm={parent_name:"总部门",parent_id:0,name:"",order_num:"",del_flag:"0"}},handleAdd:function(e){this.resetForm(),this.handleTitle="添加新部门",this.handleVisible=!0,e&&(this.deptForm.parent_name=e.text,this.deptForm.parent_id=e.id)},handleEdit:function(e){var t=this;return r()(i.a.mark(function a(){var n,l;return i.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if((n=t).handleTitle="修改部门",n.handleVisible=!0,l="",!e.hasParent){a.next=11;break}return n.deptForm.deptById=e.parentId,a.next=8,n.deptListById(n);case 8:l=a.sent,a.next=12;break;case 11:l="无";case 12:n.deptForm={dept_id:e.attributes.id,parent_name:l,parent_id:e.parentId,name:e.attributes.text,order_num:e.attributes.order_num,del_flag:e.attributes.del_flag.toString()};case 13:case"end":return a.stop()}},a,t)}))()},handleDelete:function(e){this.delVisible=!0,this.deptForm.dept_id=e.attributes.id},handleConfirm:function(){var e=this;return r()(i.a.mark(function t(){var a;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(""!==(a=e).deptForm.name){t.next=4;break}return a.$message({type:"warning",message:"部门名称不为空"}),t.abrupt("return");case 4:if(a.tableLoading=!0,"添加新部门"!==a.handleTitle){t.next=8;break}return t.next=8,a.addNewDept(a);case 8:if("修改部门"!==a.handleTitle){t.next=11;break}return t.next=11,a.editDept(a);case 11:a.handleVisible=!1;case 12:case"end":return t.stop()}},t,e)}))()},deleteRow:function(){this.tableLoading=!0,this.removeDept(this),this.delVisible=!1}})},c={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"part-manage"},[a("div",{staticClass:"button-group"},[a("span",{staticClass:"route-name"},[e._v(e._s(e.$route.meta.title))]),e._v(" "),a("el-button",{attrs:{type:"warning",size:"small",icon:"el-icon-plus"},on:{click:function(t){e.handleAdd()}}},[e._v("添加")])],1),e._v(" "),a("tree-table",{directives:[{name:"loading",rawName:"v-loading",value:e.tableLoading,expression:"tableLoading"}],attrs:{columns:e.columns,"data-source":e.deptDataList,"tree-handel":e.treeHandel,"expand-place":1},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-dropdown",{attrs:{trigger:"click",placement:"bottom"}},[a("el-button",{attrs:{type:"text",size:"mini"}},[e._v("\n          操作\n          "),a("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),e._v(" "),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-dropdown-item",[a("el-button",{attrs:{size:"mini",type:"text",icon:"el-icon-edit"},on:{click:function(a){e.handleEdit(t.row)}}},[e._v("编辑")])],1),e._v(" "),a("el-dropdown-item",[a("el-button",{attrs:{size:"mini",type:"text",icon:"el-icon-circle-plus-outline"},on:{click:function(a){e.handleAdd(t.row)}}},[e._v("添加下级")])],1),e._v(" "),a("el-dropdown-item",{attrs:{divided:""}},[a("el-button",{staticClass:"btn-text-red",attrs:{size:"mini",type:"text",icon:"el-icon-delete"},on:{click:function(a){e.handleDelete(t.row)}}},[e._v("删除")])],1)],1)],1)]}}])}),e._v(" "),a("el-dialog",{attrs:{title:e.handleTitle,visible:e.handleVisible,width:"30%",center:""},on:{"update:visible":function(t){e.handleVisible=t}}},[a("el-form",{ref:"deptForm",attrs:{model:e.deptForm,"status-icon":"","label-width":"90px",size:"small"}},[a("el-form-item",{attrs:{label:"上级部门"}},[a("el-row",[a("el-col",{attrs:{span:24}},[a("el-input",{attrs:{type:"text",disabled:""},model:{value:e.deptForm.parent_name,callback:function(t){e.$set(e.deptForm,"parent_name",t)},expression:"deptForm.parent_name"}})],1)],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"部门名称"}},[a("el-row",[a("el-col",{attrs:{span:24}},[a("el-input",{attrs:{type:"text"},model:{value:e.deptForm.name,callback:function(t){e.$set(e.deptForm,"name","string"==typeof t?t.trim():t)},expression:"deptForm.name"}})],1)],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"排序"}},[a("el-row",[a("el-col",{attrs:{span:24}},[a("el-input",{attrs:{type:"text"},model:{value:e.deptForm.order_num,callback:function(t){e.$set(e.deptForm,"order_num","string"==typeof t?t.trim():t)},expression:"deptForm.order_num"}})],1)],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"状态"}},[a("el-row",[a("el-col",{attrs:{span:24}},[a("el-radio",{attrs:{label:"0"},model:{value:e.deptForm.del_flag,callback:function(t){e.$set(e.deptForm,"del_flag","string"==typeof t?t.trim():t)},expression:"deptForm.del_flag"}},[e._v("正常")]),e._v(" "),a("el-radio",{attrs:{label:"1"},model:{value:e.deptForm.del_flag,callback:function(t){e.$set(e.deptForm,"del_flag","string"==typeof t?t.trim():t)},expression:"deptForm.del_flag"}},[e._v("禁用")])],1)],1)],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small",type:"primary",loading:e.tableLoading},on:{click:e.handleConfirm}},[e._v("确 定")]),e._v(" "),a("el-button",{attrs:{size:"small",disabled:e.tableLoading},on:{click:function(t){e.handleVisible=!1}}},[e._v("取 消")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"删除部门",visible:e.delVisible,width:"260px",center:""},on:{"update:visible":function(t){e.delVisible=t}}},[a("div",{staticClass:"del-dialog-cnt"},[e._v("删除不可恢复，是否确定删除？")]),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{size:"small",type:"danger"},on:{click:e.deleteRow}},[e._v("确 定")]),e._v(" "),a("el-button",{attrs:{size:"small"},on:{click:function(t){e.delVisible=!1}}},[e._v("取 消")])],1)])],1)},staticRenderFns:[]},u=a("VU/8")(p,c,!1,null,null,null);t.default=u.exports}});