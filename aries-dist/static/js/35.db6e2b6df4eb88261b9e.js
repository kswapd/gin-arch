webpackJsonp([35],{CT21:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=a("mvHQ"),i=a.n(o),n=a("ifoU"),l=a.n(n),s=a("Dd8w"),r=a.n(s),h=a("ZlkZ"),m=a("NYxO"),d=a("egE+"),c={data:function(){return{date:d.a,time:{text:"1小时",value:3600},resizeIds:[{id:"heap_memo_pie",width:30},{id:"heap_memo_line",width:70},{id:"non_heap_memo_pie",width:30},{id:"non_heap_memo_line",width:70},{id:"thread_pie",width:30},{id:"thread_line",width:70}],titleColor:"#000",tabName:"heapMemoTitle",timer:null,loading:!1,heapMemoLast:-1,nonHeapMemoLast:-1,threadLast:-1,heapMemoAllData:[],nonHeapMemoAllData:[],threadAllData:[],heapMemoShow:!0,nonHeapMemoShow:!0,threadShow:!0,heapMemoData:"",nonHeapMemoData:"",threadData:""}},computed:r()({},Object(m.d)({isCollapse:function(e){return e.app.isCollapse},theme:function(e){return e.app.theme}}),{coreAppParams:function(){var e=new l.a([[3600,"time(30s)"],[10800,"time(1m)"],[43200,"time(3m)"],[86400,"time(5m)"],[259200,"time(15m)"],[604800,"time(30m)"],[2592e3,"time(2h)"],[15552e3,"time(12h)"],[31536e3,"time(1d)"]]).get(this.time.value),t=this;return{moType:t.$route.query.moType,ip:t.$route.query.ip,path:t.$route.query.path,jsonTime:{heapMemory:t.heapMemoLast,nonHeapMemory:t.nonHeapMemoLast,thread:t.threadLast},resolution:e,timeRange:-1===t.heapMemoLast?t.time.value:3600}}}),watch:{heapMemoAllData:function(e){e.length>0&&(this.heapMemoShow=!0,this.heapMemoLast=e[e.length-1].time,this.heapMemoEcharts(e[e.length-1].value.toFixed(2),e))},nonHeapMemoAllData:function(e){e.length>0&&(this.nonHeapMemoShow=!0,this.nonHeapMemoLast=e[e.length-1].time,this.nonHeapMemoEcharts(e[e.length-1].value.toFixed(2),e))},threadAllData:function(e){e.length>0&&(this.threadShow=!0,this.threadLast=e[e.length-1].time,this.threadEcharts(e[e.length-1].value.toFixed(2),e))},theme:function(e){if(this.$route.query){this.titleColor={dark:"#ccc"}[e]||"#000",this.echartChange()}}},mounted:function(){this.$route.query&&this.echartChange()},beforeDestroy:function(){clearInterval(this.timer),this.timer=null},methods:{getData:function(){var e=this;e.loading=!0,e.initData(e.coreAppParams),e.timer=setInterval(function(){e.initData(e.coreAppParams)},3e4)},initData:function(e){var t=this;t.$axios({method:"post",url:h.a.findAppAll,data:i()(e)}).then(function(e){if(t.loading=!1,-1===t.coreAppParams.jsonTime.heapMemory){var a=e.data,o=a.heapMemory,i=a.nonHeapMemory,n=a.thread;t.heapMemoAllData=o||[],t.nonHeapMemoAllData=i||[],t.threadAllData=n||[]}else e.data.heapMemory&&e.data.heapMemory.length>0&&(t.heapMemoAllData=d.b.arrayConcat(t.heapMemoAllData,e.data.heapMemory)),e.data.nonHeapMemory&&e.data.nonHeapMemory.length>0&&(t.nonHeapMemoAllData=d.b.arrayConcat(t.nonHeapMemoAllData,e.data.nonHeapMemory)),e.data.thread&&e.data.thread.length>0&&(t.threadAllData=d.b.arrayConcat(t.threadAllData,e.data.thread))}).catch(function(e){t.loading=!1,t.$message.error(e&&e.data&&e.data.message||"ERROR")})},echartChange:function(e){clearInterval(this.timer),this.timer=null,this.time=e||{text:"1小时",value:3600},this.heapMemoAllData=[],this.nonHeapMemoAllData=[],this.threadAllData=[],this.heapMemoShow=!1,this.nonHeapMemoShow=!1,this.threadShow=!1,this.heapMemoLast=-1,this.nonHeapMemoLast=-1,this.threadLast=-1,this.getData()},initEcharts:function(e,t,a){var o=this,i=this.$refs[e];i.style.width=this.$refs.tabWidth.clientWidth*(a/100)+"px",null!==t&&this.$echarts.init(i).setOption(t,!0),window.addEventListener("resize",function(){i.style.width=o.$refs.tabWidth.clientWidth*(a/100)+"px",o.$echarts.init(i).resize()})},dealAxisData:function(e,t,a,o){var i=this;o.map(function(o){e.push(i.dateFtt("yyyy-MM-dd hh:mm:ss",new Date(parseInt(o.time)))),t.push(o.value.toFixed(2)),null!==a&&a.push(o.maxValue.toFixed(2))})},heapMemoEcharts:function(e,t){var a=this,o=[],i=[],n=[];if(t.length>0){a.dealAxisData(o,i,n,t),a.heapMemoData={title:"堆内存实时监控",num:e+"M",time:o[o.length-1]};var l={tooltip:{trigger:"axis"},title:{text:"堆内存统计(M)",left:"center",top:10,textStyle:{color:a.titleColor}},xAxis:{boundaryGap:!1,type:"category",axisLine:{symbol:["none","arrow"],symbolOffset:[0,10],lineStyle:{color:"#1e98d3",width:1}},axisTick:{length:"0"},axisLabel:{color:"#1e98d3"},splitLine:{show:!1},data:o},yAxis:{type:"value",axisLine:{symbol:["none","arrow"],symbolOffset:[0,10],lineStyle:{color:"#1e98d3",width:1}},axisTick:{length:"0"},axisLabel:{formatter:"{value}(M)",color:"#1e98d3"},splitLine:{show:!0,color:"#fefefe"}},series:[{name:"当前值",type:"line",itemStyle:{color:"#67C23A",lineStyle:{color:"#67C23A",width:1}},data:i},{name:"最大值",type:"line",itemStyle:{color:"#409EFF",lineStyle:{color:"#67C23A",width:1}},data:n}]};this.initEcharts("heap_memo_line",l,a.resizeIds[1].width),a.heapMemoShow=!0}else a.heapMemoShow=!1},nonHeapMemoEcharts:function(e,t){var a=this,o=[],i=[],n=[];if(t.length>0){a.dealAxisData(o,i,n,t),a.nonHeapMemoData={title:"非堆内存实时监控",num:e+"M",time:o[o.length-1]};var l={tooltip:{trigger:"axis"},title:{text:"非堆内存统计(M)",left:"center",top:10,textStyle:{color:a.titleColor}},xAxis:{boundaryGap:!1,type:"category",axisLine:{symbol:["none","arrow"],symbolOffset:[0,10],lineStyle:{color:"#1e98d3",width:1}},axisTick:{length:"0"},axisLabel:{color:"#1e98d3"},data:o},yAxis:{type:"value",axisLine:{symbol:["none","arrow"],symbolOffset:[0,10],lineStyle:{color:"#1e98d3",width:1}},axisTick:{length:"0"},axisLabel:{formatter:"{value}(M)",color:"#1e98d3"}},series:[{name:"当前值",type:"line",itemStyle:{color:"#67C23A",lineStyle:{color:"#67C23A",width:1}},data:i},{name:"最大值",type:"line",itemStyle:{color:"#409EFF",lineStyle:{color:"#67C23A",width:1}},data:n}]};this.initEcharts("non_heap_memo_line",l,a.resizeIds[3].width),a.nonHeapMemoShow=!0}else a.nonHeapMemoShow=!1},threadEcharts:function(e,t){var a=this,o=[],i=[];if(t.length>0){a.dealAxisData(o,i,null,t),a.threadData={title:"线程数实时监控",num:parseInt(e).toFixed(0)+"个",time:o[o.length-1]};var n={tooltip:{trigger:"axis"},title:{text:"线程数量统计(个)",left:"center",top:10,textStyle:{color:a.titleColor}},xAxis:{boundaryGap:!1,type:"category",axisLine:{symbol:["none","arrow"],symbolOffset:[0,10],lineStyle:{color:"#1e98d3",width:1}},axisTick:{length:"0"},axisLabel:{color:"#1e98d3"},splitLine:{show:!1},data:o},yAxis:{type:"value",axisLine:{symbol:["none","arrow"],symbolOffset:[0,10],lineStyle:{color:"#1e98d3",width:1}},axisTick:{length:"0"},axisLabel:{formatter:"{value}(个)",color:"#1e98d3"},splitLine:{show:!0,color:"#fefefe"}},series:[{name:"线程数量统计",type:"line",itemStyle:{color:"#67C23A",lineStyle:{color:"#67C23A",width:1}},data:i}]};this.initEcharts("thread_line",n,a.resizeIds[5].width),a.threadShow=!0}else a.threadShow=!1}}},p={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"core-echarts"},[a("div",{staticClass:"detail-back"},[a("a",{on:{click:function(t){e.$router.push({name:"coreList"})}}},[a("i",{staticClass:"iconfont icon-fanhui"}),e._v("返回")]),e._v(" "),a("span",{domProps:{textContent:e._s(e.$route.meta.title+"-"+e.$route.query.moType+"-"+e.$route.query.ip)}})]),e._v(" "),a("el-row",{staticClass:"rd_bottom"},[a("span",{staticStyle:{"line-height":"40px"}},[e._v(e._s(e.$t("echarts.timeSpan")+"："))]),e._v(" "),e._l(e.date,function(t){return a("el-button",{key:t.value,class:{chooseColor:t.text===e.time.text},attrs:{size:"mini"},on:{click:function(a){e.echartChange(t)}}},[e._v(e._s(t.text)+"\n    ")])})],2),e._v(" "),a("div",[a("span",[e._v("时间：")]),a("span",{staticClass:"rd_time"},[e._v(e._s(e.time.text))]),e._v(" "),a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"tabWidth"},[a("el-tabs",{model:{value:e.tabName,callback:function(t){e.tabName=t},expression:"tabName"}},[a("el-tab-pane",{attrs:{label:e.$t("coreAppEcharts.heapMemoTitle"),name:"heapMemoTitle"}},[a("el-row",{directives:[{name:"show",rawName:"v-show",value:e.heapMemoShow,expression:"heapMemoShow"}]},[a("el-col",{attrs:{span:8}},[a("div",{ref:"heap_memo_pie",staticClass:"echarts"},[a("dc-num-show",{attrs:{"num-data":e.heapMemoData}})],1)]),e._v(" "),a("el-col",{attrs:{span:16}},[a("div",{ref:"heap_memo_line",staticClass:"echarts"})])],1),e._v(" "),a("el-row",{directives:[{name:"show",rawName:"v-show",value:!e.heapMemoShow,expression:"!heapMemoShow"}],staticClass:"no-data"},[a("el-col",[e._v("暂无数据")])],1)],1),e._v(" "),a("el-tab-pane",{attrs:{label:e.$t("coreAppEcharts.nonHeapMemoTitle"),name:"nonHeapMemoTitle"}},[a("el-row",{directives:[{name:"show",rawName:"v-show",value:e.nonHeapMemoShow,expression:"nonHeapMemoShow"}]},[a("el-col",{attrs:{span:8}},[a("div",{ref:"non_heap_memo_pie",staticClass:"echarts"},[a("dc-num-show",{attrs:{"num-data":e.nonHeapMemoData}})],1)]),e._v(" "),a("el-col",{attrs:{span:16}},[a("div",{ref:"non_heap_memo_line",staticClass:"echarts"})])],1),e._v(" "),a("el-row",{directives:[{name:"show",rawName:"v-show",value:!e.nonHeapMemoShow,expression:"!nonHeapMemoShow"}],staticClass:"no-data"},[a("el-col",[e._v("暂无数据")])],1)],1),e._v(" "),a("el-tab-pane",{attrs:{label:e.$t("coreAppEcharts.threadTitle"),name:"threadTitle"}},[a("el-row",{directives:[{name:"show",rawName:"v-show",value:e.threadShow,expression:"threadShow"}]},[a("el-col",{attrs:{span:8}},[a("div",{ref:"thread_pie",staticClass:"echarts"},[a("dc-num-show",{attrs:{"num-data":e.threadData}})],1)]),e._v(" "),a("el-col",{attrs:{span:16}},[a("div",{ref:"thread_line",staticClass:"echarts"})])],1),e._v(" "),a("el-row",{directives:[{name:"show",rawName:"v-show",value:!e.threadShow,expression:"!threadShow"}],staticClass:"no-data"},[a("el-col",[e._v("暂无数据")])],1)],1)],1)],1)])],1)},staticRenderFns:[]};var u=a("VU/8")(c,p,!1,function(e){a("cPK3")},"data-v-44cf9f52",null);t.default=u.exports},cPK3:function(e,t){}});