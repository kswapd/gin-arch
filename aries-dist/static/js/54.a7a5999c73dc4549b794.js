webpackJsonp([54],{AwKk:function(e,t){},FpKx:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=s("Dd8w"),l=s.n(a),r=s("NYxO"),i={data:function(){return{currentUserId:localStorage.getItem("userInfo")?JSON.parse(localStorage.getItem("userInfo")).userId:NaN,userManageForm:{},deptId:0,handleTitle:"",searchName:"",handleVisible:!1,deptVisible:!1,delVisible:!1,resetVisible:!1,currentPage:1,totalCount:10,pageSize:10,tableLoading:!0,defaultProps:{children:"children",label:"text"},userForm:{name:"",username:"",password:"",dept:"",dept_id:"",email:"",status:"0",role_ids:[]},resetForm:{pwd_new:""},multipleSelection:[]}},computed:l()({},Object(r.d)({deptTree:function(e){return e.authority.deptTree},userDataList:function(e){return e.authority.userDataList},roleDataList:function(e){return e.authority.roleDataList}})),mounted:function(){var e=this;e.getData(),e.getRoleList(e),e.getDeptTree(e)},methods:l()({},Object(r.b)("authority",["getUserList","getRoleList","getDeptTree","addUser","editUser","removeUserOne","resetPwd","batchRemove"]),{resetUser:function(){this.userForm={name:"",username:"",password:"",dept:"",dept_id:"",email:"",status:"0",role_ids:[]}},getData:function(){var e=this;e.userPara={page:e.currentPage,per_page:e.pageSize,name:e.searchName,deptId:e.deptId},e.getUserList(e)},handleNodeClick:function(e){this.deptId="-1"===e.id?"0":e.id,this.getData()},handleSearch:function(){this.tableLoading=!0,this.getData()},handleSizeChange:function(e){this.pageSize=e,this.getData()},handleCurrentChange:function(e){this.currentPage=e,this.getData()},handleAdd:function(){this.resetUser(),this.handleTitle="添加用户",this.handleVisible=!0},handleEdit:function(e){this.handleTitle="修改用户",this.handleVisible=!0,this.userForm={userId:e.userId,name:e.name,username:e.username,password:e.password,dept:e.dept_name,email:e.email,status:e.status.toString(),role_ids:null===e.role_ids?[]:e.role_ids}},handleDelete:function(e){if(e)this.userForm.userId=e.userId,this.multipleSelection=[];else if(0===this.multipleSelection.length)return this.$message.warning("请勾选用户"),!1;this.delVisible=!0},handleConfirm:function(){var e=this;""===e.userForm.email||e.regExpEmail(e.userForm.email)?""!==e.userForm.dept?""!==e.userForm.password?""!==e.userForm.username?(e.tableLoading=!0,"添加用户"===e.handleTitle&&e.addUser(e),"修改用户"===e.handleTitle&&e.editUser(e)):e.$message({type:"warning",message:"用户名不为空"}):e.$message({type:"warning",message:"密码不为空"}):e.$message({type:"warning",message:"部门不为空"}):e.$message({type:"warning",message:"邮箱格式不正确"})},showTree:function(){this.deptVisible=!0,this.$refs.deptInput.blur()},handleDeptClick:function(e){this.deptVisible=!1,this.userForm.dept=e.text,this.userForm.dept_id=e.id},deleteRow:function(){this.tableLoading=!0,this.multipleSelection.length>0?this.batchRemove(this):this.removeUserOne(this),this.delVisible=!1},resetPassword:function(e){this.resetVisible=!0,this.resetForm.user_id=e.userId},resetConfirm:function(){""!==this.resetForm.pwd_new?this.resetPwd(this):this.$message({type:"error",message:"密码不为空"})},resetCancel:function(){this.resetForm={},this.resetVisible=!1},handleSelectionChange:function(e){this.multipleSelection=this.arrayIdList(e,"userId")}})},o={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"user-manage"},[s("div",{staticClass:"button-group"},[s("span",{staticClass:"route-name"},[e._v(e._s(e.$route.meta.title))]),e._v(" "),s("el-button",{attrs:{type:"warning",size:"small",icon:"el-icon-plus"},on:{click:e.handleAdd}},[e._v("添加")]),e._v(" "),e.multipleSelection.length>0?s("el-button",{attrs:{loading:e.tableLoading,type:"danger",size:"small"},on:{click:function(t){e.handleDelete()}}},[s("i",{staticClass:"fa fa-trash"}),e._v(" 删除")]):e._e()],1),e._v(" "),s("el-form",{ref:"userManageForm",attrs:{model:e.userManageForm,"label-width":"55px",size:"small"}},[s("el-row",{staticClass:"label-first",attrs:{gutter:20}},[s("el-col",{attrs:{lg:6,xl:4}},[s("el-form-item",{attrs:{label:"姓名："}},[s("el-input",{attrs:{size:"small",type:"text",placeholder:"姓名"},model:{value:e.searchName,callback:function(t){e.searchName="string"==typeof t?t.trim():t},expression:"searchName"}})],1)],1),e._v(" "),s("el-col",{attrs:{lg:6,xl:4}},[s("el-button",{attrs:{type:"primary",size:"small",loading:e.tableLoading,icon:"el-icon-search"},on:{click:e.handleSearch}},[e._v("搜索")])],1)],1)],1),e._v(" "),s("el-row",{attrs:{gutter:20}},[s("el-col",{attrs:{span:5}},[s("div",{staticClass:"left-tree"},[s("div",{staticClass:"tree-title"},[e._v("选择部门")]),e._v(" "),s("el-tree",{staticClass:"tree-body",attrs:{"default-expand-all":!0,data:e.deptTree,props:e.defaultProps},on:{"node-click":e.handleNodeClick}})],1)]),e._v(" "),s("el-col",{attrs:{span:19}},[s("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.tableLoading,expression:"tableLoading"}],ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:e.userDataList,stripe:""},on:{"selection-change":e.handleSelectionChange}},[s("el-table-column",{attrs:{type:"selection",width:"55"}}),e._v(" "),s("el-table-column",{attrs:{prop:"userId",label:"序号",width:"70"}}),e._v(" "),s("el-table-column",{attrs:{prop:"name",label:"姓名"}}),e._v(" "),s("el-table-column",{attrs:{prop:"username",label:"用户名"}}),e._v(" "),s("el-table-column",{attrs:{prop:"email",label:"邮箱"}}),e._v(" "),s("el-table-column",{attrs:{prop:"status",label:"状态",align:"center",width:"90"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-tag",{attrs:{type:0===t.row.status?"success":"danger","disable-transitions":""}},[e._v(e._s(e._f("userStatus")(t.row.status))+"\n            ")])]}}])}),e._v(" "),s("el-table-column",{attrs:{label:"操作",align:"center",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-dropdown",{attrs:{trigger:"click",placement:"bottom"}},[s("el-button",{attrs:{type:"text",size:"mini"}},[e._v("\n                操作"),s("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),e._v(" "),s("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[s("el-dropdown-item",[s("el-button",{attrs:{size:"mini",type:"text",icon:"el-icon-edit"},on:{click:function(s){e.handleEdit(t.row)}}},[e._v("编辑")])],1),e._v(" "),s("el-dropdown-item",[s("el-button",{attrs:{size:"mini",type:"text",icon:"el-icon-view"},on:{click:function(s){e.resetPassword(t.row)}}},[e._v("重置密码")])],1),e._v(" "),s("el-dropdown-item",{attrs:{divided:""}},[s("el-button",{staticClass:"btn-text-red",attrs:{size:"mini",type:"text",icon:"el-icon-delete"},on:{click:function(s){e.handleDelete(t.row)}}},[e._v("删除")])],1)],1)],1)]}}])})],1),e._v(" "),s("el-pagination",{attrs:{"current-page":e.currentPage,"page-sizes":[10,20,50,100],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.totalCount},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1),e._v(" "),s("el-dialog",{attrs:{title:e.handleTitle,visible:e.handleVisible,width:"30%",center:""},on:{"update:visible":function(t){e.handleVisible=t}}},[s("el-form",{ref:"userForm",attrs:{model:e.userForm,"status-icon":"","label-width":"90px",size:"small"}},[s("el-form-item",{attrs:{label:"姓名"}},[s("el-row",[s("el-col",{attrs:{span:24}},[s("el-input",{attrs:{maxlength:"50",type:"text"},model:{value:e.userForm.name,callback:function(t){e.$set(e.userForm,"name","string"==typeof t?t.trim():t)},expression:"userForm.name"}})],1)],1)],1),e._v(" "),s("el-form-item",{attrs:{label:"用户名"}},[s("el-row",[s("el-col",{attrs:{span:24}},[s("el-input",{attrs:{maxlength:"30",disabled:e.userForm.userId,type:"text"},model:{value:e.userForm.username,callback:function(t){e.$set(e.userForm,"username","string"==typeof t?t.trim():t)},expression:"userForm.username"}})],1)],1)],1),e._v(" "),"添加用户"===e.handleTitle?s("el-form-item",{attrs:{label:"密码"}},[s("el-row",[s("el-col",{attrs:{span:24}},[s("el-input",{attrs:{maxlength:"30",type:"text"},model:{value:e.userForm.password,callback:function(t){e.$set(e.userForm,"password","string"==typeof t?t.trim():t)},expression:"userForm.password"}})],1)],1)],1):e._e(),e._v(" "),s("el-form-item",{attrs:{label:"部门"}},[s("el-row",[s("el-col",{attrs:{span:24}},[s("el-input",{ref:"deptInput",attrs:{type:"text",placeholder:"所属部门",readonly:""},on:{focus:e.showTree},model:{value:e.userForm.dept,callback:function(t){e.$set(e.userForm,"dept","string"==typeof t?t.trim():t)},expression:"userForm.dept"}})],1)],1)],1),e._v(" "),s("el-form-item",{attrs:{label:"邮件"}},[s("el-row",[s("el-col",{attrs:{span:24}},[s("el-input",{attrs:{maxlength:"50",type:"text"},model:{value:e.userForm.email,callback:function(t){e.$set(e.userForm,"email","string"==typeof t?t.trim():t)},expression:"userForm.email"}})],1)],1)],1),e._v(" "),s("el-form-item",{attrs:{label:"状态"}},[s("el-row",[s("el-col",{attrs:{span:24}},[s("el-radio",{attrs:{label:"0"},model:{value:e.userForm.status,callback:function(t){e.$set(e.userForm,"status",t)},expression:"userForm.status"}},[e._v("正常")]),e._v(" "),s("el-radio",{attrs:{label:"1"},model:{value:e.userForm.status,callback:function(t){e.$set(e.userForm,"status",t)},expression:"userForm.status"}},[e._v("禁用")])],1)],1)],1),e._v(" "),s("el-form-item",{attrs:{label:"角色"}},[s("el-row",[s("el-col",{attrs:{span:24}},[s("el-checkbox-group",{model:{value:e.userForm.role_ids,callback:function(t){e.$set(e.userForm,"role_ids",t)},expression:"userForm.role_ids"}},e._l(e.roleDataList,function(t){return s("el-checkbox",{key:t.role_id,attrs:{label:t.role_id}},[e._v(e._s(t.role_name)+"\n              ")])}))],1)],1)],1)],1),e._v(" "),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{size:"small",loading:e.tableLoading,type:"primary"},on:{click:e.handleConfirm}},[e._v("确 定")]),e._v(" "),s("el-button",{attrs:{size:"small",disabled:e.tableLoading},on:{click:function(t){e.handleVisible=!1}}},[e._v("取 消")])],1)],1),e._v(" "),s("el-dialog",{attrs:{title:"所属部门",visible:e.deptVisible,width:"15%",center:""},on:{"update:visible":function(t){e.deptVisible=t}}},[s("el-tree",{staticClass:"tree-body",attrs:{"default-expand-all":!0,data:e.deptTree,props:e.defaultProps},on:{"node-click":e.handleDeptClick}})],1),e._v(" "),s("el-dialog",{attrs:{title:"删除用户",visible:e.delVisible,width:"260px",center:""},on:{"update:visible":function(t){e.delVisible=t}}},[s("div",{staticClass:"del-dialog-cnt"},[e._v("删除不可恢复，是否确定删除？")]),e._v(" "),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{size:"small",type:"danger"},on:{click:e.deleteRow}},[e._v("确 定")]),e._v(" "),s("el-button",{attrs:{size:"small"},on:{click:function(t){e.delVisible=!1}}},[e._v("取 消")])],1)]),e._v(" "),s("el-dialog",{attrs:{title:"重置密码",visible:e.resetVisible,width:"20%",center:""},on:{"update:visible":function(t){e.resetVisible=t}}},[s("el-form",{ref:"resetForm",attrs:{model:e.resetForm,"status-icon":"","label-width":"90px",size:"small"}},[s("el-form-item",{attrs:{label:"新密码"}},[s("el-row",[s("el-col",{attrs:{span:24}},[s("el-input",{attrs:{type:"text"},model:{value:e.resetForm.pwd_new,callback:function(t){e.$set(e.resetForm,"pwd_new","string"==typeof t?t.trim():t)},expression:"resetForm.pwd_new"}})],1)],1)],1)],1),e._v(" "),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{attrs:{size:"small",type:"danger",loading:e.tableLoading},on:{click:e.resetConfirm}},[e._v("确 定")]),e._v(" "),s("el-button",{attrs:{size:"small",disabled:e.tableLoading},on:{click:e.resetCancel}},[e._v("取 消")])],1)],1)],1)},staticRenderFns:[]};var n=s("VU/8")(i,o,!1,function(e){s("AwKk")},"data-v-0eac3a59",null);t.default=n.exports}});