webpackJsonp([19],{"F/5U":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=a("Xxa5"),r=a.n(o),s=a("exGp"),i=a.n(s),n=a("Dd8w"),l=a.n(n),c=a("NYxO"),m=a("0uvK"),d={data:function(){var t=this,e=/^(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])\.(\d{1,2}|1\d\d|2[0-4]\d|25[0-5])$/,a=function(a,o,r){e.test(t.editForm[a.field])?r():r(new Error("ip格式不对"))};return{currentPage:1,pageSize:10,hostVisible:!1,tableLoading:!1,hostForm:{name:"",ip:""},oldIp:"",title:"",editForm:{},editFormRules:{name:[{required:!0,message:"请输入主机名",trigger:"blur"}],ip:[{required:!0,validator:a}],startIp:[{required:!0,validator:a}],endIp:[{required:!0,validator:a}],os:[{required:!0,message:"请输入环境变量",trigger:"blur"}],javaHome:[{required:!0,message:"请输入环境变量",trigger:"blur"}]},cpuOptions:["2","4","8","16"],envGroups:[{text:"OMS内测环境",value:"OMS内测环境"},{text:"GZPOC",value:"GZPOC"}]}},computed:l()({},Object(c.d)({hostList:function(t){return t.host.hostList}})),created:function(){this.searchHostData()},methods:l()({},Object(c.b)("host",["getHostList","modifyHost","addHost","addMoreHost","deleteHostAxios"]),{getList:function(){var t=this;return i()(r.a.mark(function e(){var a,o;return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o={pageNo:(a=t).currentPage,limit:a.pageSize,baseParam:a.hostForm},a.tableLoading=!0,e.next=5,a.getHostList(o);case 5:a.tableLoading=!1;case 6:case"end":return e.stop()}},e,t)}))()},searchHostData:function(){this.getList()},editHost:function(t){var e=this;t?(e.title="修改主机",e.oldIp=t.ip,e.editForm=l()({},t),e.hostVisible=!0):(e.title="添加主机",e.editForm={moType:"Host",os:"Linux",status:"single"},e.hostVisible=!0)},getIpValue:function(t){this.editForm.ip=t},getStartIpValue:function(t){this.editForm.startIp=t},getEndIpValue:function(t){this.editForm.endIp=t},dialogSure:function(){var t,e=this,a=this;a.$refs.editForm.validate((t=i()(r.a.mark(function t(o){return r.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!o){t.next=28;break}if(!a.editForm.moId){t.next=6;break}a.tableLoading=!0,a.modifyHost([a.oldIp,a.editForm,function(){a.$message({type:"success",message:"修改成功"}),a.dialogCancel(),a.searchHostData()}]),t.next=26;break;case 6:if(t.prev=6,a.tableLoading=!0,"single"!==a.editForm.status){t.next=13;break}return delete a.editForm.startIp,delete a.editForm.endIp,t.next=13,a.addHost(a.editForm);case 13:if("more"!==a.editForm.status){t.next=17;break}return delete a.editForm.ip,t.next=17,a.addMoreHost(a.editForm);case 17:a.$message({type:"success",message:"添加成功"}),a.dialogCancel(),a.searchHostData(),t.next=26;break;case 22:t.prev=22,t.t0=t.catch(6),a.$message({type:"error",message:t.t0.data&&t.t0.data.message||"添加失败"}),a.tableLoading=!1;case 26:t.next=29;break;case 28:a.$message({type:"warning",message:"带*是必输项"});case 29:case"end":return t.stop()}},t,e,[[6,22]])})),function(e){return t.apply(this,arguments)}))},dialogCancel:function(){this.hostVisible=!1,this.$refs.editForm.clearValidate()},deleteHost:function(t){var e=this,a=this;a.$confirm("是否确认删除主机"+t.name+"？","删除",{confirmButtonText:a.$t("common.ok"),cancelButtonText:a.$t("common.cancel"),type:"warning",center:!0}).then(i()(r.a.mark(function o(){return r.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,a.tableLoading=!0,e.next=4,a.deleteHostAxios({moId:t.moId});case 4:e.sent.code===m.d&&(a.$message({type:"success",message:"删除成功！"}),a.searchHostData()),e.next=12;break;case 8:e.prev=8,e.t0=e.catch(0),a.$message({type:"success",message:e.t0.data&&e.t0.data.message||"删除失败"}),a.tableLoading=!1;case 12:case"end":return e.stop()}},o,e,[[0,8]])}))).catch(function(){})},handleCurrentChange:function(t){this.currentPage=t,this.searchHostData()},moniter:function(t){this.$router.push({name:"hostEcharts",query:{ip:t.row.ip},params:{id:t.row.ip}})}})},u={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"host-main"},[a("div",{staticClass:"button-group"},[a("span",{staticClass:"route-name"},[t._v(t._s(t.$route.meta.title))]),t._v(" "),a("el-button",{attrs:{type:"warning",size:"small",icon:"el-icon-plus"},on:{click:function(e){t.editHost()}}},[t._v(t._s(t.$t("common.add")))])],1),t._v(" "),a("el-form",{ref:"hostForm",attrs:{model:t.hostForm,"label-width":"70px","label-position":"right",size:"small"}},[a("el-row",{staticClass:"label-first",attrs:{gutter:20}},[a("el-col",{attrs:{lg:6,xl:4}},[a("el-form-item",{attrs:{label:t.$t("host.hostName")+"：",prop:"name"}},[a("el-input",{model:{value:t.hostForm.name,callback:function(e){t.$set(t.hostForm,"name","string"==typeof e?e.trim():e)},expression:"hostForm.name"}})],1)],1),t._v(" "),a("el-col",{attrs:{lg:6,xl:4}},[a("el-form-item",{attrs:{label:"IP：",prop:"ip"}},[a("el-input",{model:{value:t.hostForm.ip,callback:function(e){t.$set(t.hostForm,"ip","string"==typeof e?e.trim():e)},expression:"hostForm.ip"}})],1)],1),t._v(" "),a("el-col",{attrs:{lg:6,xl:4}},[a("el-button",{attrs:{type:"primary",loading:t.tableLoading,icon:"el-icon-search",size:"small"},on:{click:t.searchHostData}},[t._v("\n          "+t._s(t.$t("common.search"))+"\n        ")])],1)],1)],1),t._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.tableLoading,expression:"tableLoading"}],attrs:{data:t.hostList.data,stripe:""}},[a("el-table-column",{attrs:{align:"center",prop:"name",label:t.$t("host.hostName"),width:"150"}}),t._v(" "),a("el-table-column",{attrs:{prop:"ip",align:"center",label:t.$t("host.IP"),width:"180"}}),t._v(" "),a("el-table-column",{attrs:{prop:"core",align:"center",label:t.$t("host.cpu"),width:"100"}}),t._v(" "),a("el-table-column",{attrs:{align:"center",label:t.$t("host.memory"),width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n        "+t._s(t._f("hostMemory")(e.row.memory))+"\n      ")]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"os",align:"center",label:t.$t("host.os"),width:"150"}}),t._v(" "),a("el-table-column",{attrs:{label:t.$t("host.watch"),width:"100",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"text",size:"small",icon:"fa fa-bar-chart"},on:{click:function(a){t.moniter(e)}}})]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"remark",align:"center",label:t.$t("host.desc"),"min-width":"100"}}),t._v(" "),a("el-table-column",{attrs:{label:t.$t("common.operation"),align:"center",fixed:"right",width:"140"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"text",size:"mini",icon:"el-icon-edit"},on:{click:function(a){t.editHost(e.row)}}},[t._v(t._s(t.$t("common.modify"))+"\n        ")]),t._v(" "),a("el-button",{staticClass:"btn-text-red",attrs:{type:"text",size:"mini",icon:"el-icon-delete"},on:{click:function(a){t.deleteHost(e.row)}}},[t._v(t._s(t.$t("common.delete"))+"\n        ")])]}}])})],1),t._v(" "),a("el-pagination",{attrs:{background:"","current-page":t.currentPage,"page-size":t.pageSize,disabled:t.tableLoading,layout:"total, prev, pager, next, jumper",total:t.hostList.total},on:{"current-change":t.handleCurrentChange,"update:currentPage":function(e){t.currentPage=e}}}),t._v(" "),a("el-dialog",{attrs:{title:t.title,visible:t.hostVisible,width:"35%",center:""},on:{"update:visible":function(e){t.hostVisible=e},close:t.dialogCancel}},[a("el-form",{ref:"editForm",attrs:{model:t.editForm,rules:t.editFormRules,"label-width":"80px",size:"small"}},["添加主机"===t.title?a("el-form-item",[a("el-radio-group",{model:{value:t.editForm.status,callback:function(e){t.$set(t.editForm,"status",e)},expression:"editForm.status"}},[a("el-radio",{attrs:{label:"single"}},[t._v("单个添加")]),t._v(" "),a("el-radio",{attrs:{label:"more"}},[t._v("批量添加")])],1)],1):t._e(),t._v(" "),"single"===t.editForm.status||"修改主机"===t.title?a("div",[a("el-form-item",{key:"singleIp",attrs:{label:t.$t("host.IP"),prop:"ip"}},[a("gl-ip-input",{on:{getIpValue:t.getIpValue},model:{value:t.editForm.ip,callback:function(e){t.$set(t.editForm,"ip",e)},expression:"editForm.ip"}})],1),t._v(" "),a("el-form-item",{attrs:{label:t.$t("host.hostName"),prop:"name"}},[a("el-input",{attrs:{maxlength:"50"},model:{value:t.editForm.name,callback:function(e){t.$set(t.editForm,"name","string"==typeof e?e.trim():e)},expression:"editForm.name"}})],1)],1):a("div",{key:"moreIp"},[a("el-form-item",{attrs:{label:t.$t("host.IP")+"(从)",prop:"startIp"}},[a("gl-ip-input",{on:{getIpValue:t.getStartIpValue},model:{value:t.editForm.startIp,callback:function(e){t.$set(t.editForm,"startIp",e)},expression:"editForm.startIp"}})],1),t._v(" "),a("el-form-item",{attrs:{label:t.$t("host.IP")+"(到)",prop:"endIp"}},[a("gl-ip-input",{on:{getIpValue:t.getEndIpValue},model:{value:t.editForm.endIp,callback:function(e){t.$set(t.editForm,"endIp",e)},expression:"editForm.endIp"}})],1)],1),t._v(" "),a("el-form-item",{attrs:{label:t.$t("host.cpu")}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:t.$t("common.select")},model:{value:t.editForm.core,callback:function(e){t.$set(t.editForm,"core",e)},expression:"editForm.core"}},t._l(t.cpuOptions,function(t,e){return a("el-option",{key:e,attrs:{label:t,value:t}})}))],1),t._v(" "),a("el-form-item",{attrs:{label:t.$t("host.memory")}},[a("el-input",{attrs:{placeholder:"请输入内存大小"},model:{value:t.editForm.memory,callback:function(e){t.$set(t.editForm,"memory",t._n("string"==typeof e?e.trim():e))},expression:"editForm.memory"}},[a("template",{slot:"append"},[t._v("G")])],2)],1),t._v(" "),a("el-form-item",{attrs:{label:t.$t("host.os"),prop:"os"}},[a("el-input",{attrs:{disabled:""},model:{value:t.editForm.os,callback:function(e){t.$set(t.editForm,"os",e)},expression:"editForm.os"}})],1),t._v(" "),a("el-form-item",{attrs:{label:"环境变量",prop:"javaHome"}},[a("el-input",{attrs:{maxlength:"50"},model:{value:t.editForm.javaHome,callback:function(e){t.$set(t.editForm,"javaHome","string"==typeof e?e.trim():e)},expression:"editForm.javaHome"}})],1),t._v(" "),a("el-form-item",{attrs:{label:t.$t("host.desc")}},[a("el-input",{attrs:{type:"textarea",maxlength:"100"},model:{value:t.editForm.remark,callback:function(e){t.$set(t.editForm,"remark","string"==typeof e?e.trim():e)},expression:"editForm.remark"}})],1)],1),t._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary",loading:t.tableLoading,size:"small"},on:{click:t.dialogSure}},[t._v(t._s(t.$t("common.ok")))]),t._v(" "),a("el-button",{attrs:{disabled:t.tableLoading,size:"small"},on:{click:t.dialogCancel}},[t._v(t._s(t.$t("common.cancel")))])],1)],1)],1)},staticRenderFns:[]};var p=a("VU/8")(d,u,!1,function(t){a("k9jI")},"data-v-cbb466ea",null);e.default=p.exports},k9jI:function(t,e){}});