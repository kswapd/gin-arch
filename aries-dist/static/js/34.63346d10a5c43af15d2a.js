webpackJsonp([34],{kCwo:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("mvHQ"),n=a.n(i),o=a("ifoU"),l=a.n(o),s=a("Dd8w"),r=a.n(s),h=a("ZlkZ"),d=a("NYxO"),c=a("egE+"),u={data:function(){return{date:c.a,time:{text:"1小时",value:3600},resizeIds:[{id:"num_alive_pie",width:30},{id:"num_alive_line",width:70},{id:"data_size_pie",width:30},{id:"data_size_line",width:70},{id:"node_count_pie",width:30},{id:"node_count_line",width:70},{id:"watch_count_pie",width:30},{id:"watch_count_line",width:70}],titleColor:"#000",tabName:"numAliveTitle",timer:null,loading:!1,numAliveLast:-1,nodeCountLast:-1,dataSizeLast:-1,watchCountLast:-1,numAliveAllData:[],nodeCountAllData:[],dataSizeAllData:[],watchCountAllData:[],numAliveData:"",nodeCountData:"",dataSizeData:"",watchCountData:"",numAliveShow:!0,nodeCountShow:!0,dataSizeShow:!0,watchCountShow:!0}},computed:r()({},Object(d.d)({isCollapse:function(t){return t.app.isCollapse},theme:function(t){return t.app.theme}}),{zkParams:function(){var t=new l.a([[3600,"time(30s)"],[10800,"time(1m)"],[43200,"time(3m)"],[86400,"time(5m)"],[259200,"time(15m)"],[604800,"time(30m)"],[2592e3,"time(2h)"],[15552e3,"time(12h)"],[31536e3,"time(1d)"]]).get(this.time.value),e=this;return{moType:"Zookeeper",ip:e.$route.query.ip,path:e.$route.query.path,jsonTime:{numAliveConnections:e.numAliveLast,nodeCount:e.nodeCountLast,dataSize:e.dataSizeLast,watchCount:e.watchCountLast},resolution:t,timeRange:-1===e.numAliveLast?e.time.value:3600}}}),watch:{numAliveAllData:function(t){t.length>0&&(this.numAliveShow=!0,this.numAliveLast=t[t.length-1].time,this.numAliveEcharts(t[t.length-1].value.toFixed(2),t))},nodeCountAllData:function(t){t.length>0&&(this.nodeCountShow=!0,this.nodeCountLast=t[t.length-1].time,this.nodeCountEcharts(t[t.length-1].value.toFixed(2),t))},dataSizeAllData:function(t){t.length>0&&(this.dataSizeShow=!0,this.dataSizeLast=t[t.length-1].time,this.dataSizeEcharts(t[t.length-1].value.toFixed(2),t))},watchCountAllData:function(t){t.length>0&&(this.watchCountShow=!0,this.watchCountLast=t[t.length-1].time,this.watchCountEcharts(t[t.length-1].value.toFixed(2),t))},theme:function(t){if(this.$route.query){this.titleColor={dark:"#ccc"}[t]||"#000",this.echartChange()}}},mounted:function(){this.$route.query&&this.echartChange()},beforeDestroy:function(){clearInterval(this.timer),this.timer=null},methods:{getData:function(){var t=this;t.loading=!0,t.initData(t.zkParams),t.timer=setInterval(function(){t.initData(t.zkParams)},3e4)},initData:function(t){var e=this;e.$axios({method:"post",url:h.a.findZkAll,data:n()(t)}).then(function(t){if(e.loading=!1,-1===e.zkParams.jsonTime.numAliveConnections){var a=t.data,i=a.numAliveConnections,n=a.dataSize,o=a.nodeCount,l=a.watchCount;e.numAliveAllData=i||[],e.nodeCountAllData=n||[],e.dataSizeAllData=o||[],e.watchCountAllData=l||[]}else t.data.numAliveConnections&&t.data.numAliveConnections.length>0&&(e.numAliveAllData=c.b.arrayConcat(e.numAliveAllData,t.data.numAliveConnections)),t.data.nodeCount&&t.data.nodeCount.length>0&&(e.nodeCountAllData=c.b.arrayConcat(e.nodeCountAllData,t.data.nodeCount)),t.data.dataSize&&t.data.dataSize.length>0&&(e.dataSizeAllData=c.b.arrayConcat(e.dataSizeAllData,t.data.dataSize)),t.data.watchCount&&t.data.watchCount.length>0&&(e.watchCountAllData=c.b.arrayConcat(e.watchCountAllData,t.data.watchCount))}).catch(function(t){e.loading=!1,e.$message.error(t&&t.data&&t.data.message||"ERROR")})},echartChange:function(t){clearInterval(this.timer),this.timer=null,this.time=t||{text:"1小时",value:3600},this.numAliveShow=!1,this.nodeCountShow=!1,this.dataSizeShow=!1,this.watchCountShow=!1,this.numAliveAllData=[],this.nodeCountAllData=[],this.dataSizeAllData=[],this.watchCountAllData=[],this.numAliveLast=-1,this.nodeCountLast=-1,this.dataSizeLast=-1,this.watchCountLast=-1,this.getData()},initEcharts:function(t,e,a){var i=this,n=this.$refs[t];n.style.width=this.$refs.tabWidth.clientWidth*(a/100)+"px",null!==e&&this.$echarts.init(n).setOption(e,!0),window.addEventListener("resize",function(){n.style.width=i.$refs.tabWidth.clientWidth*(a/100)+"px",i.$echarts.init(n).resize()})},dealAxisData:function(t,e,a){var i=this;a.map(function(a){t.push(i.dateFtt("yyyy-MM-dd hh:mm:ss",new Date(parseInt(a.time)))),e.push(a.value.toFixed(2))})},numAliveEcharts:function(t,e){var a=this,i=[],n=[];if(e.length>0){a.dealAxisData(i,n,e),a.numAliveData={title:"连接数实时监控",num:parseInt(t).toFixed(0)+"个",time:i[i.length-1]};var o={tooltip:{trigger:"axis"},title:{text:"连接数统计(个)",left:"center",top:10,textStyle:{color:a.titleColor}},xAxis:{boundaryGap:!1,type:"category",axisLine:{symbol:["none","arrow"],symbolOffset:[0,10],lineStyle:{color:"#1e98d3",width:1}},axisTick:{length:"0"},axisLabel:{color:"#1e98d3"},splitLine:{show:!1},data:i},yAxis:{type:"value",axisLine:{symbol:["none","arrow"],symbolOffset:[0,10],lineStyle:{color:"#1e98d3",width:1}},axisTick:{length:"0"},axisLabel:{formatter:"{value}(个)",color:"#1e98d3"},splitLine:{show:!0,color:"#fefefe"}},series:[{name:"连接数统计",type:"line",itemStyle:{color:"#67C23A",lineStyle:{color:"#67C23A",width:1}},data:n}]};this.initEcharts("num_alive_line",o,a.resizeIds[1].width),a.numAliveShow=!0}else a.numAliveShow=!1},dataSizeEcharts:function(t,e){var a=this,i=[],n=[];if(e.length>0){a.dealAxisData(i,n,e),a.dataSizeData={title:"节点大小实时监控",num:t+"KB",time:i[i.length-1]};var o={tooltip:{trigger:"axis"},title:{text:"节点大小统计(KB)",left:"center",top:10,textStyle:{color:a.titleColor}},xAxis:{boundaryGap:!1,type:"category",axisLine:{symbol:["none","arrow"],symbolOffset:[0,10],lineStyle:{color:"#1e98d3",width:1}},axisTick:{length:"0"},axisLabel:{color:"#1e98d3"},data:i},yAxis:{type:"value",axisLine:{symbol:["none","arrow"],symbolOffset:[0,10],lineStyle:{color:"#1e98d3",width:1}},axisTick:{length:"0"},axisLabel:{formatter:"{value}(kb)",color:"#1e98d3"}},series:[{name:"节点大小统计",type:"line",itemStyle:{color:"#67C23A",lineStyle:{color:"#67C23A",width:1}},data:n}]};this.initEcharts("data_size_line",o,a.resizeIds[3].width),a.dataSizeShow=!0}else a.dataSizeShow=!1},nodeCountEcharts:function(t,e){var a=this,i=[],n=[];if(e.length>0){a.dealAxisData(i,n,e),a.nodeCountData={title:"节点数实时监控",num:parseInt(t).toFixed(0)+"个",time:i[i.length-1]};var o={tooltip:{trigger:"axis"},title:{text:"节点数量统计(个)",left:"center",top:10,textStyle:{color:a.titleColor}},xAxis:{boundaryGap:!1,type:"category",axisLine:{symbol:["none","arrow"],symbolOffset:[0,10],lineStyle:{color:"#1e98d3",width:1}},axisTick:{length:"0"},axisLabel:{color:"#1e98d3"},splitLine:{show:!1},data:i},yAxis:{type:"value",axisLine:{symbol:["none","arrow"],symbolOffset:[0,10],lineStyle:{color:"#1e98d3",width:1}},axisTick:{length:"0"},axisLabel:{formatter:"{value}(个)",color:"#1e98d3"},splitLine:{show:!0,color:"#fefefe"}},series:[{name:"节点数量统计",type:"line",itemStyle:{color:"#67C23A",lineStyle:{color:"#67C23A",width:1}},data:n}]};this.initEcharts("node_count_line",o,a.resizeIds[5].width),a.nodeCountShow=!0}else a.nodeCountShow=!1},watchCountEcharts:function(t,e){var a=this,i=[],n=[];if(e.length>0){a.dealAxisData(i,n,e),a.watchCountData={title:"Watcher数实时监控",num:parseInt(t).toFixed(0)+"个",time:i[i.length-1]};var o={tooltip:{trigger:"axis"},title:{text:"Watcher数量(个)",left:"center",top:10,textStyle:{color:a.titleColor}},xAxis:{boundaryGap:!1,type:"category",axisLine:{symbol:["none","arrow"],symbolOffset:[0,10],lineStyle:{color:"#1e98d3",width:1}},axisTick:{length:"0"},axisLabel:{color:"#1e98d3"},data:i},yAxis:{type:"value",axisLine:{symbol:["none","arrow"],symbolOffset:[0,10],lineStyle:{color:"#1e98d3",width:1}},axisTick:{length:"0"},axisLabel:{formatter:"{value}(个)",color:"#1e98d3"}},series:[{name:"Watcher数量",type:"line",itemStyle:{color:"#67C23A",lineStyle:{color:"#67C23A",width:1}},data:n}]};this.initEcharts("watch_count_line",o,a.resizeIds[7].width),a.watchCountShow=!0}else a.watchCountShow=!1}}},m={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"zk-echarts"},[a("div",{staticClass:"detail-back"},[a("a",{on:{click:function(e){t.$router.push({name:"zkList"})}}},[a("i",{staticClass:"iconfont icon-fanhui"}),t._v("返回")]),t._v(" "),a("span",{domProps:{textContent:t._s(t.$route.meta.title+"-"+t.$route.query.ip)}})]),t._v(" "),a("el-row",{staticClass:"rd_bottom"},[a("span",{staticStyle:{"line-height":"40px"}},[t._v(t._s(t.$t("echarts.timeSpan")+"："))]),t._v(" "),t._l(t.date,function(e){return a("el-button",{key:e.value,class:{chooseColor:e.text===t.time.text},attrs:{size:"mini",disabled:t.loading},on:{click:function(a){t.echartChange(e)}}},[t._v(t._s(e.text)+"\n    ")])})],2),t._v(" "),a("div",[a("span",[t._v("时间：")]),a("span",{staticClass:"rd_time"},[t._v(t._s(t.time.text))]),t._v(" "),a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"tabWidth"},[a("el-tabs",{model:{value:t.tabName,callback:function(e){t.tabName=e},expression:"tabName"}},[a("el-tab-pane",{attrs:{label:t.$t("zkEcharts.numAliveTitle"),name:"numAliveTitle"}},[a("el-row",{directives:[{name:"show",rawName:"v-show",value:t.numAliveShow,expression:"numAliveShow"}]},[a("el-col",{attrs:{span:8}},[a("div",{ref:"num_alive_pie",staticClass:"echarts"},[a("dc-num-show",{attrs:{"num-data":t.numAliveData}})],1)]),t._v(" "),a("el-col",{attrs:{span:16}},[a("div",{ref:"num_alive_line",staticClass:"echarts"})])],1),t._v(" "),a("el-row",{directives:[{name:"show",rawName:"v-show",value:!t.numAliveShow,expression:"!numAliveShow"}],staticClass:"no-data"},[a("el-col",[t._v("暂无数据")])],1)],1),t._v(" "),a("el-tab-pane",{attrs:{label:t.$t("zkEcharts.dataSizeTitle"),name:"dataSizeTitle"}},[a("el-row",{directives:[{name:"show",rawName:"v-show",value:t.dataSizeShow,expression:"dataSizeShow"}]},[a("el-col",{attrs:{span:8}},[a("div",{ref:"data_size_pie",staticClass:"echarts"},[a("dc-num-show",{attrs:{"num-data":t.dataSizeData}})],1)]),t._v(" "),a("el-col",{attrs:{span:16}},[a("div",{ref:"data_size_line",staticClass:"echarts"})])],1),t._v(" "),a("el-row",{directives:[{name:"show",rawName:"v-show",value:!t.dataSizeShow,expression:"!dataSizeShow"}],staticClass:"no-data"},[a("el-col",[t._v("暂无数据")])],1)],1),t._v(" "),a("el-tab-pane",{attrs:{label:t.$t("zkEcharts.nodeCountTitle"),name:"nodeCountTitle"}},[a("el-row",{directives:[{name:"show",rawName:"v-show",value:t.nodeCountShow,expression:"nodeCountShow"}]},[a("el-col",{attrs:{span:8}},[a("div",{ref:"node_count_pie",staticClass:"echarts"},[a("dc-num-show",{attrs:{"num-data":t.nodeCountData}})],1)]),t._v(" "),a("el-col",{attrs:{span:16}},[a("div",{ref:"node_count_line",staticClass:"echarts"})])],1),t._v(" "),a("el-row",{directives:[{name:"show",rawName:"v-show",value:!t.nodeCountShow,expression:"!nodeCountShow"}],staticClass:"no-data"},[a("el-col",[t._v("暂无数据")])],1)],1),t._v(" "),a("el-tab-pane",{attrs:{label:t.$t("zkEcharts.watchCountTitle"),name:"watchCountTitle"}},[a("el-row",{directives:[{name:"show",rawName:"v-show",value:t.watchCountShow,expression:"watchCountShow"}]},[a("el-col",{attrs:{span:8}},[a("div",{ref:"watch_count_pie",staticClass:"echarts"},[a("dc-num-show",{attrs:{"num-data":t.watchCountData}})],1)]),t._v(" "),a("el-col",{attrs:{span:16}},[a("div",{ref:"watch_count_line",staticClass:"echarts"})])],1),t._v(" "),a("el-row",{directives:[{name:"show",rawName:"v-show",value:!t.watchCountShow,expression:"!watchCountShow"}],staticClass:"no-data"},[a("el-col",[t._v("暂无数据")])],1)],1)],1)],1)])],1)},staticRenderFns:[]};var w=a("VU/8")(u,m,!1,function(t){a("rQEW")},"data-v-4a45726b",null);e.default=w.exports},rQEW:function(t,e){}});