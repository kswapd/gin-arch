webpackJsonp([25],{Pfsu:function(t,e){},"t+jv":function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=a("Dd8w"),i=a.n(s),l=a("NYxO"),r={data:function(){return{activated:0,currentPage:0,pageSize:10,radio:"变更的配置",releaseTitle:"",releaseTime:"",rules:[],addMoreFlag:!0,color:["#316510","#997f1c","#999"],desc:""}},computed:i()({},Object(l.d)({historyList:function(t){return t.releaseHis.historyList},hisChanges:function(t){return t.releaseHis.hisChanges}})),mounted:function(){var t=this;t.hisParams=t.$route.query,t.desc="(AppId："+t.hisParams.appId+"；ENV："+t.hisParams.env+"；Cluster："+t.hisParams.clusterName+"；NameSpace："+t.hisParams.namespaceName+")",t.getHisData()},methods:i()({},Object(l.b)("releaseHis",["getReleaseHis","getCompared"]),{getHisData:function(){this.getReleaseHis(this)},handleConfig:function(t,e){var a=this;a.activated=t,a.releaseTitle=e.releaseTitle,a.releaseTime=e.releaseTime,a.rules=e.operationContext.rules,a.env=a.hisParams.env,a.compareParams={baseReleaseId:e.previousReleaseId,toCompareReleaseId:e.releaseId},a.getCompared(a)},goBack:function(){this.currentPage=0,this.$router.push({name:"configDetail",query:{appId:this.hisParams.appId},params:{id:this.hisParams.appId}})},addMore:function(){this.currentPage++,this.getHisData()}})},o={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"his-container"},[a("div",{staticClass:"his-header clearfix"},[a("div",{staticClass:"hd-left"},[a("div",{staticStyle:{"margin-top":"40px"}},[a("el-row",[a("el-col",{attrs:{span:8}},[a("span",{staticClass:"hd-flag",style:{background:t.color[0]}},[t._v("主版本发布")])]),t._v(" "),a("el-col",{attrs:{span:8}},[a("span",{staticClass:"hd-flag",style:{background:t.color[1]}},[t._v("主版本回滚")])]),t._v(" "),a("el-col",{attrs:{span:8}},[a("span",{staticClass:"hd-flag",style:{background:t.color[2]}},[t._v("灰度操作")])])],1)],1)]),t._v(" "),a("div",{staticClass:"hd-center"},[a("div",{staticClass:"hd-title"},[t._v("发布历史")]),t._v(" "),a("div",{staticClass:"hd-desc"},[t._v(t._s(t.desc))])]),t._v(" "),a("div",{staticClass:"hd-right"},[a("div",{staticClass:"hd-btn"},[a("el-button",{attrs:{type:"primary",size:"small"},on:{click:t.goBack}},[t._v("返回项目首页")])],1)])]),t._v(" "),a("div",{staticClass:"his-main clearfix"},[a("div",{staticClass:"main-left"},[a("div",{staticClass:"main-left-in"},[a("ul",[t._l(t.historyList,function(e,s){return a("li",{key:e.id,class:{active:s===t.activated,"left-item":!0},on:{click:function(a){t.handleConfig(s,e)}}},[a("div",{class:{"item-style":!0,"operation-normal":0==e.operation||5==e.operation,"operation-gray":2==e.operation||3==e.operation||4==e.operation||7==e.operation||8==e.operation,"operation-rollback":1==e.operation||6==e.operation}},[a("el-row",{attrs:{gutter:5}},[a("el-col",{staticClass:"text-overflow",attrs:{span:8}},[t._v(t._s(e.operator))]),t._v(" "),a("el-col",{staticClass:"text-overflow",attrs:{span:8}},[t._v(t._s(t._f("operationType")(e.operation)))]),t._v(" "),a("el-col",{staticClass:"text-overflow",attrs:{span:8}},[t._v(t._s(e.releaseTimeFormatted))])],1)],1)])}),t._v(" "),t.addMoreFlag?a("li",[a("div",{staticClass:"more-style",on:{click:t.addMore}},[t._v("加载更多 "),a("i",{staticClass:"el-icon-arrow-down"})])]):a("li",[a("div",{staticClass:"end-style"},[t._v("已经到底")])])],2)])]),t._v(" "),a("div",{staticClass:"main-right"},[a("div",{staticClass:"main-hd"},[a("div",{staticClass:"hd-row"},[a("div",{staticClass:"hd-text",staticStyle:{position:"absolute",left:"0"}},[t._v(t._s(t.releaseTitle))]),t._v(" "),a("div",{staticClass:"hd-text"},[t._v(t._s(t._f("formatDateTime")(t.releaseTime)))])]),t._v(" "),a("div",{staticClass:"hd-row"},[a("el-radio-group",{attrs:{size:"small"},model:{value:t.radio,callback:function(e){t.radio=e},expression:"radio"}},[a("el-radio-button",{attrs:{label:"变更的配置"}}),t._v(" "),a("el-radio-button",{attrs:{label:"全部配置"}})],1)],1)]),t._v(" "),a("div",{staticClass:"main-change"},[a("div",{staticClass:"main-title"},[t._v(t._s(t.radio))]),t._v(" "),t.hisChanges===[]?a("div",{staticClass:"no-data"},[t._v("无配置更改")]):t._e(),t._v(" "),t.hisChanges!=[]&&"变更的配置"===t.radio?a("div",[a("el-table",{key:"changes-table",staticStyle:{width:"100%"},attrs:{data:t.hisChanges,stripe:"","max-height":"140"}},[a("el-table-column",{attrs:{label:"Type"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(t._f("changeType")(e.row.type)))])]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"entity.firstEntity.key",label:"Key"}}),t._v(" "),a("el-table-column",{attrs:{prop:"entity.firstEntity.value",label:"Old Value"}}),t._v(" "),a("el-table-column",{attrs:{prop:"entity.secondEntity.value",label:"New Value"}})],1)],1):t._e(),t._v(" "),t.hisChanges!=[]&&"全部配置"===t.radio?a("div",[a("el-table",{key:"all-table",staticStyle:{width:"100%"},attrs:{data:t.hisChanges,stripe:"","max-height":"140"}},[a("el-table-column",{attrs:{prop:"entity.firstEntity.key",label:"Key"}}),t._v(" "),a("el-table-column",{attrs:{prop:"entity.secondEntity.value",label:"Value"}})],1)],1):t._e()]),t._v(" "),a("div",{staticClass:"main-gray"},[a("div",{staticClass:"main-title"},[t._v("灰度规则")]),t._v(" "),t.rules===[]?a("div",{staticClass:"no-data"},[t._v("无灰度规则")]):a("el-table",{key:"rules-table",staticStyle:{width:"100%"},attrs:{data:t.rules,stripe:"","max-height":"140"}},[a("el-table-column",{attrs:{prop:"clientAppId",label:"灰度的AppId"}}),t._v(" "),a("el-table-column",{attrs:{label:"灰度的IP"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(e.row.clientIpList.join("，")))])]}}])})],1)],1)])])])},staticRenderFns:[]};var n=a("VU/8")(r,o,!1,function(t){a("Pfsu")},"data-v-7afcf0dc",null);e.default=n.exports}});