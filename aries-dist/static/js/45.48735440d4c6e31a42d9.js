webpackJsonp([45],{H3Lu:function(e,t){},"b+Wm":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=a("Xxa5"),l=a.n(r),n=a("exGp"),s=a.n(n),o=a("Dd8w"),c=a.n(o),i=a("NYxO"),u=a("ZlkZ"),m={data:function(){return{currentPage:1,pageSize:10,clusterVisible:!1,clusterForm:{name:""},title:"",clusterAlertForm:{},clusterAlertRules:{name:[{required:!0,message:"请输入集群名称",trigger:"blur"}]},tableLoading:!1}},computed:c()({},Object(i.d)({clusterInfo:function(e){return e.zookeeper.clusterInfo}})),created:function(){this.getTableData()},methods:c()({},Object(i.b)("zookeeper",["getClusterList","operationTable"]),{searchCluster:function(){this.getTableData()},getTableData:function(){var e=this;return s()(l.a.mark(function t(){var a,r;return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r={start:(a=e).currentPage,length:a.pageSize},a.clusterForm.name&&(r.name=a.clusterForm.name),a.tableLoading=!0,t.next=6,a.getClusterList(r);case 6:a.tableLoading=!1;case 7:case"end":return t.stop()}},t,e)}))()},deleteCluster:function(e){var t=this;t.$confirm("是否确认删除集群"+e.name+"？","删除",{confirmButtonText:t.$t("common.ok"),cancelButtonText:t.$t("common.cancel"),type:"warning",center:!0}).then(function(){t.tableLoading=!0,t.currentPage=1,t.operationTable({url:u.a.zkClusterDelete,data:{id:e.id},callback:function(){t.$message({type:"success",message:"删除成功"}),t.currentPage=1,t.getTableData()},callbackError:function(e){t.$message({type:"error",message:e.data&&e.data.message||"删除失败"}),t.tableLoading=!1}})}).catch(function(){})},modifyCluster:function(e){var t=this;e?(t.title="修改zk集群",t.clusterAlertForm=c()({},e),t.clusterVisible=!0):(t.title="添加zk集群",t.clusterAlertForm={},t.clusterVisible=!0)},handleCurrentChange:function(e){this.currentPage=e,this.getTableData()},clusterCancel:function(){this.clusterVisible=!1,this.$refs.clusterAlertForm.clearValidate()},clusterOk:function(e){var t=this;t.$refs[e].validate(function(e){e&&(t.tableLoading=!0,t.clusterAlertForm.id?t.operationTable({url:u.a.zkClusterUpdate,data:t.clusterAlertForm,callback:function(){t.$message({type:"success",message:"修改成功"}),t.clusterCancel(),t.getTableData()},callbackError:function(e){t.$message({type:"error",message:e.data&&e.data.message||"修改失败"}),t.tableLoading=!1}}):t.operationTable({url:u.a.zkClusterAdd,data:t.clusterAlertForm,callback:function(){t.$message({type:"success",message:"添加成功"}),t.clusterCancel(),t.getTableData()},callbackError:function(e){t.$message({type:"error",message:e.data&&e.data.message||"添加失败"}),t.tableLoading=!1}}))})}})},d={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"zk-main"},[a("div",{staticClass:"button-group"},[a("span",{staticClass:"route-name"},[e._v(e._s(e.$route.meta.title))]),e._v(" "),a("el-button",{attrs:{icon:"el-icon-plus",size:"small",type:"warning"},on:{click:function(t){e.modifyCluster()}}},[e._v(e._s(e.$t("common.add")))])],1),e._v(" "),a("el-form",{ref:"clusterForm",attrs:{model:e.clusterForm,"label-width":"85px","label-position":"right",size:"small"}},[a("el-row",{staticClass:"label-first",attrs:{gutter:20}},[a("el-col",{attrs:{lg:6,xl:4}},[a("el-form-item",{attrs:{label:"集群名称："}},[a("el-input",{model:{value:e.clusterForm.name,callback:function(t){e.$set(e.clusterForm,"name","string"==typeof t?t.trim():t)},expression:"clusterForm.name"}})],1)],1),e._v(" "),a("el-col",{attrs:{lg:6,xl:4}},[a("el-button",{attrs:{type:"primary",loading:e.tableLoading,icon:"el-icon-search",size:"small"},on:{click:e.searchCluster}},[e._v(e._s(e.$t("common.search")))])],1)],1)],1),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.tableLoading,expression:"tableLoading"}],attrs:{data:e.clusterInfo.list,stripe:""}},[a("el-table-column",{attrs:{prop:"name",align:"center",label:"集群名称",width:"300"}}),e._v(" "),a("el-table-column",{attrs:{label:"集群详情",width:"150px",align:"center"},scopedSlots:e._u([{key:"default",fn:function(e){return[a("router-link",{attrs:{to:{name:"zkList",params:e.row}}},[a("i",{staticClass:"fa fa-cubes font-16 pointer"})])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"remark",align:"center",label:"备注"}}),e._v(" "),a("el-table-column",{attrs:{width:"200",align:"center",label:e.$t("common.operation")},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",size:"mini",icon:"el-icon-edit"},on:{click:function(a){e.modifyCluster(t.row)}}},[e._v(e._s(e.$t("common.modify")))]),e._v(" "),a("el-button",{staticClass:"btn-text-red",attrs:{type:"text",size:"mini",icon:"el-icon-delete"},on:{click:function(a){e.deleteCluster(t.row)}}},[e._v("\n          "+e._s(e.$t("common.delete"))+"\n        ")])]}}])})],1),e._v(" "),a("el-pagination",{attrs:{background:"","current-page":e.currentPage,"page-size":e.pageSize,layout:"total, prev, pager, next, jumper",disabled:e.tableLoading,total:e.clusterInfo.total},on:{"current-change":e.handleCurrentChange,"update:currentPage":function(t){e.currentPage=t}}}),e._v(" "),a("el-dialog",{attrs:{title:e.title,visible:e.clusterVisible,width:"30%",center:""},on:{"update:visible":function(t){e.clusterVisible=t},close:e.clusterCancel}},[a("el-form",{ref:"clusterAlertForm",attrs:{model:e.clusterAlertForm,rules:e.clusterAlertRules,"label-width":"80px",size:"small"}},[a("el-form-item",{attrs:{label:"集群名称",prop:"name"}},[a("el-input",{attrs:{maxlength:"50"},model:{value:e.clusterAlertForm.name,callback:function(t){e.$set(e.clusterAlertForm,"name","string"==typeof t?t.trim():t)},expression:"clusterAlertForm.name"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"描述",prop:"remark"}},[a("el-input",{attrs:{type:"textarea",maxlength:"100"},model:{value:e.clusterAlertForm.remark,callback:function(t){e.$set(e.clusterAlertForm,"remark","string"==typeof t?t.trim():t)},expression:"clusterAlertForm.remark"}}),e._v(" "),a("div",{staticClass:"remark-length"},[e._v(e._s(e.clusterAlertForm.remark?e.clusterAlertForm.remark.length:"0")+"/100")])],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary",loading:e.tableLoading,size:"small"},on:{click:function(t){e.clusterOk("clusterAlertForm")}}},[e._v(e._s(e.$t("common.ok")))]),e._v(" "),a("el-button",{attrs:{disabled:e.tableLoading,size:"small"},on:{click:e.clusterCancel}},[e._v(e._s(e.$t("common.cancel")))])],1)],1)],1)},staticRenderFns:[]};var g=a("VU/8")(m,d,!1,function(e){a("H3Lu")},"data-v-3579ba88",null);t.default=g.exports}});